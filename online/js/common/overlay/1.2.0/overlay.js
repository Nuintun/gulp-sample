define("common/overlay/1.2.0/overlay",["base/jquery/1.11.2/jquery","util/position/1.1.0/position","util/iframe-shim/1.1.0/iframe-shim","base/widget/1.2.0/widget"],function(e,t,i){function n(e){return r.contains(document.documentElement,e)}function s(e){r(u.blurOverlays).each(function(t,i){if(i&&i.get("visible")){for(var n=0;n<i._relativeElements.length;n++){var s=r(i._relativeElements[n])[0];if(s===e.target||r.contains(s,e.target))return}i.hide()}})}function o(e,t){for(var i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),t}var r=e("base/jquery/1.11.2/jquery"),l=e("util/position/1.1.0/position"),h=e("util/iframe-shim/1.1.0/iframe-shim"),a=e("base/widget/1.2.0/widget"),u=a.extend({attrs:{width:null,height:null,zIndex:99,visible:!1,align:{selfXY:[0,0],baseElement:l.VIEWPORT,baseXY:[0,0]},parentNode:document.body},show:function(){return this.rendered||this.render(),this.set("visible",!0),this},hide:function(){return this.set("visible",!1),this},setup:function(){var e=this;this._setupShim(),this._setupResize(),this.after("render",function(){var e=this.element.css("position");("static"===e||"relative"===e)&&this.element.css({position:"absolute",left:"-9999px",top:"-9999px"})}),this.after("show",function(){e._setPosition()})},destroy:function(){return o(this,u.allOverlays),o(this,u.blurOverlays),u.superclass.destroy.call(this)},_setPosition:function(e){if(n(this.element[0])&&(e||(e=this.get("align")),e)){var t="none"===this.element.css("display");return t&&this.element.css({visibility:"hidden",display:"block"}),l.pin({element:this.element,x:e.selfXY[0],y:e.selfXY[1]},{element:e.baseElement,x:e.baseXY[0],y:e.baseXY[1]}),t&&this.element.css({visibility:"",display:"none"}),this}},_setupShim:function(){var e=new h(this.element);this.after("hide _setPosition",e.sync,e);var t=["width","height"];for(var i in t)t.hasOwnProperty(i)&&this.on("change:"+i,e.sync,e);this.before("destroy",e.destroy,e)},_setupResize:function(){u.allOverlays.push(this)},_blurHide:function(e){e=r.makeArray(e),e.push(this.element),this._relativeElements=e,u.blurOverlays.push(this)},_onRenderWidth:function(e){this.element.css("width",e)},_onRenderHeight:function(e){this.element.css("height",e)},_onRenderZIndex:function(e){this.element.css("zIndex",e)},_onRenderAlign:function(e){this._setPosition(e)},_onRenderVisible:function(e){this.element[e?"show":"hide"]()}});u.blurOverlays=[],r(document).on("click",function(e){s(e)});var c,d=r(window).width(),f=r(window).height();u.allOverlays=[],r(window).resize(function(){c&&clearTimeout(c),c=setTimeout(function(){var e=r(window).width(),t=r(window).height();(d!==e||f!==t)&&r(u.allOverlays).each(function(e,t){t&&t.get("visible")&&t._setPosition()}),d=e,f=t},80)}),i.exports=u});